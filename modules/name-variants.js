/**
 * Модуль для роботи з варіантами імен
 * Містить розширений словник зменшувальних форм та різних варіантів написання імен
 */

/**
 * Словник варіантів імен з їхніми стандартними формами
 * Використовується для нормалізації імен до стандартної форми
 * Включає українські зменшувальні імена, російські варіанти імен та додаткові форми
 */
export const nameVariants = {
    // Варіанти українських імен
    'ліза': 'єлизавета',
    'лізи': 'єлизавета',
    'єлизавета': 'єлизавета',
    'женя': 'євгеній',
    'жені': 'євгенія',
    'євген': 'євгеній',
    'євгенія': 'євгенія',
    'саша': 'олександр',
    'олесь': 'олександр',
    'шура': 'олександр',
    'оля': 'ольга',
    'наташа': 'наталія',
    'ната': 'наталія',
    'наталя': 'наталія',
    'діма': 'дмитро',
    'дима': 'дмитро',
    'міша': 'михайло',
    'миша': 'михайло',
    'тарас': 'тарас',
    'сергій': 'сергій',
    'сергей': 'сергій',
    'серьожа': 'сергій',
    'сєрожа': 'сергій',
    'сережа': 'сергій',
    'юра': 'юрій',
    'юрчик': 'юрій',
    'юля': 'юлія',
    'юлія': 'юлія',
    'ігор': 'ігор',
    'макс': 'максим',
    'максим': 'максим',
    'настя': 'анастасія',
    'віка': 'вікторія',
    'віталій': 'віталій',
    'віталик': 'віталій',
    'олег': 'олег',
    'андрій': 'андрій',
    'ваня': 'іван',
    'іван': 'іван',
    'вова': 'володимир',
    'володя': 'володимир',
    'володимир': 'володимир',
    'петро': 'петро',
    'петя': 'петро',
    'павло': 'павло',
    'паша': 'павло',
    'влад': 'Владислав',
    
    // Додаткові варіанти для жіночих імен
    'галя': 'галина',
    'галина': 'галина',
    'таня': 'тетяна',
    'танюша': 'тетяна',
    'тетяна': 'тетяна',
    'люда': 'людмила',
    'людмила': 'людмила',
    'маша': 'марія',
    'марія': 'марія',
    'леся': 'олександра',
    'олександра': 'олександра',
    'катя': 'катерина',
    'катюша': 'катерина',
    'катерина': 'катерина',
    'валя': 'валентина',
    'валентина': 'валентина',
    'іра': 'ірина',
    'ірина': 'ірина',
    'світлана': 'світлана',
    'світа': 'світлана',
    'лариса': 'лариса',
    'лара': 'лариса',
    'зоя': 'зоя',
    'зоряна': 'зоряна',
    'аня': 'анна',
    'анна': 'анна',
    'ганна': 'ганна',
    'неля': 'неля',
    'нелля': 'неля',
    'неллі': 'неля',
    'ніна': 'ніна',
    'інна': 'інна',
    'інеса': 'інеса',
    'інесса': 'інеса',
    'валерія': 'валерія',
    'лера': 'валерія',
    'лєра': 'валерія',
    
    // Додаткові варіанти для чоловічих імен
    'костя': 'костянтин',
    'кость': 'костянтин',
    'костік': 'костянтин',
    'костянтин': 'костянтин',
    'льоша': 'олексій',
    'олексій': 'олексій',
    'альоша': 'олексій',
    'олеша': 'олексій',
    'леша': 'олексій',
    'рома': 'роман',
    'ромчик': 'роман',
    'роман': 'роман',
    'толя': 'анатолій',
    'анатолій': 'анатолій',
    'валера': 'валерій',
    'валєра': 'валерій',
    'валерій': 'валерій',
    'гриша': 'григорій',
    'гріша': 'григорій',
    'григорій': 'григорій',
    'степан': 'степан',
    'стьопа': 'степан',
    'стефан': 'степан',
    'матвій': 'матвій',
    'мотя': 'матвій',
    'матвей': 'матвій',
    'нікіта': 'микита',
    'микита': 'микита',
    'коля': 'микола',
    'микола': 'микола',
    'славік': 'в\'ячеслав',
    'слава': 'в\'ячеслав',
    'в\'ячеслав': 'в\'ячеслав',
    'ярик': 'ярослав',
    'ярослав': 'ярослав',
    'богдан': 'богдан',
    'данило': 'данило',
    'данііл': 'данило',
    'даня': 'данило',
    'данік': 'данило',
    'ростик': 'ростислав',
    'ростислав': 'ростислав',
    'вітя': 'віктор',
    'вітьок': 'віктор',
    'віктор': 'віктор',
    'артем': 'артем',
    'тьома': 'артем',
    'тьомик': 'артем',
    'артьом': 'артем',
    'антон': 'антон',
    'антоша': 'антон',
    'денис': 'денис',
    'денчик': 'денис',
    
    // Російські варіанти
    'игорь': 'ігор',
    'александр': 'олександр',
    'алексей': 'олексій',
    'елена': 'олена',
    'дмитрий': 'дмитро',
    'николай': 'микола',
    'михаил': 'михайло',
    'сергей': 'сергій',
    'евгений': 'євгеній',
    'татьяна': 'тетяна',
    'юрий': 'юрій',
    'анна': 'анна',
    'валентина': 'валентина',
    'екатерина': 'катерина',
    'наталья': 'наталія',
    'ольга': 'ольга',
    'иван': 'іван',
    'мария': 'марія',
    'маша': 'марія',
    'илья': 'ілля',
    'илия': 'ілля',
    'константин': 'костянтин',
    'андрей': 'андрій',
    'петр': 'петро',
    'павел': 'павло',
    'антон': 'антон',
    'борис': 'борис',
    'василий': 'василь',
    'вячеслав': 'в\'ячеслав',
    'григорий': 'григорій',
    'виктор': 'віктор',
    'анатолий': 'анатолій',
    'кирилл': 'кирило',
    'леонид': 'леонід',
    'владимир': 'володимир',
    'валерий': 'валерій',
    'роман': 'роман',
    'степан': 'степан',
    'геннадий': 'геннадій',
    'ярослав': 'ярослав',
    'лариса': 'лариса',
    'галина': 'галина',
    'светлана': 'світлана',
    'ирина': 'ірина',
    'инна': 'інна',
    'инесса': 'інеса',
    'надежда': 'надія',
    'людмила': 'людмила',
    'зоя': 'зоя',
    'валерия': 'валерія',
    'марина': 'марина',
    'оксана': 'оксана',
    'тамара': 'тамара',
    'вера': 'віра',
    
    // Англійські варіанти імен (для випадків англомовних ресурсів)
    'alex': 'олександр',
    'alexander': 'олександр',
    'sasha': 'олександр',
    'mike': 'михайло',
    'michael': 'михайло',
    'nick': 'микола',
    'nicholas': 'микола',
    'kate': 'катерина',
    'katherine': 'катерина',
    'catherine': 'катерина',
    'ann': 'анна',
    'anna': 'анна',
    'eugene': 'євгеній',
    'mary': 'марія',
    'maria': 'марія',
    'andrew': 'андрій',
    'andy': 'андрій',
    'peter': 'петро',
    'paul': 'павло',
    'olga': 'ольга',
    'george': 'георгій',
    'igor': 'ігор',
    'victor': 'віктор',
    'victoria': 'вікторія',
    'vicky': 'вікторія',
    'elizabeth': 'єлизавета',
    'lisa': 'єлизавета'
  };
  
  /**
   * Отримує стандартну форму імені з варіанту
   * @param {string} name - Вхідний варіант імені
   * @returns {string} Стандартизована форма імені
   */
  export function getStandardNameForm(name) {
    if (!name) return '';
    
    const nameLower = name.toLowerCase();
    return nameVariants[nameLower] || nameLower;
  }
  
  /**
   * Перевіряє, чи є ім'я зменшувальною формою іншого імені
   * @param {string} nameVariant - Варіант імені для перевірки
   * @param {string} standardName - Стандартне ім'я
   * @returns {boolean} True, якщо nameVariant є варіантом standardName
   */
  export function isVariantOf(nameVariant, standardName) {
    if (!nameVariant || !standardName) return false;
    
    const variantLower = nameVariant.toLowerCase();
    const standardLower = standardName.toLowerCase();
    
    // Перевірка прямого співпадіння
    if (variantLower === standardLower) return true;
    
    // Перевірка через словник
    const standardForm = getStandardNameForm(variantLower);
    
    // Перевірка з використанням конвертації з російської
    if (standardForm !== variantLower) {
      return standardForm === standardLower;
    }
    
    // Спроба конвертувати з російської, якщо стандартна форма не знайдена
    const ukrainianVariant = russianToUkrainian(variantLower);
    if (ukrainianVariant !== variantLower) {
      const standardFormAfterConversion = getStandardNameForm(ukrainianVariant);
      return standardFormAfterConversion === standardLower;
    }
    
    return false;
  }
  
  /**
   * Перевіряє, чи починається ім'я з певного префіксу
   * Корисно для скорочених імен
   * @param {string} name - Ім'я для перевірки
   * @param {string} prefix - Префікс для пошуку
   * @returns {boolean} True, якщо ім'я починається з префіксу
   */
  export function startsWithPrefix(name, prefix) {
    if (!name || !prefix) return false;
    
    const nameLower = name.toLowerCase();
    const prefixLower = prefix.toLowerCase();
    
    return nameLower.startsWith(prefixLower);
  }
  
  /**
   * Отримує всі можливі стандартні імена для заданого варіанту
   * @param {string} variant - Варіант імені
   * @returns {string[]} Масив можливих стандартних імен
   */
  export function getAllPossibleStandardNames(variant) {
    if (!variant) return [];
    
    const variantLower = variant.toLowerCase();
    const directMatch = nameVariants[variantLower];
    
    if (directMatch) return [directMatch];
    
    // Пошук імен, які можуть бути варіантами за префіксом
    const possibleMatches = [];
    for (const [key, value] of Object.entries(nameVariants)) {
      // Якщо варіант починається з ключа словника або ключ починається з варіанту
      if (variantLower.startsWith(key) || key.startsWith(variantLower)) {
        possibleMatches.push(value);
      }
    }
    
    return [...new Set(possibleMatches)]; // Повертаємо унікальні значення
  }
  
  /**
   * Конвертує російські символи в українські
   * @param {string} text - Текст для конвертації
   * @returns {string} Текст з заміненими символами
   */
  export function russianToUkrainian(text) {
    if (!text) return '';
    
    const replacements = {
      'ы': 'и',
      'э': 'е',
      'ё': 'йо',
      'ъ': '',
      'ьё': 'ьо',
      'ьи': 'ьі'
    };
    
    let result = text;
    for (const [rus, ukr] of Object.entries(replacements)) {
      result = result.replace(new RegExp(rus, 'g'), ukr);
    }
    
    return result;
  }